'use client'\n\nimport { useState, useEffect } from 'react'\nimport { createClientComponentClient } from '@supabase/auth-helpers-nextjs'\nimport { notFound } from 'next/navigation'\nimport { MapPin, Ruler, Building2, Calendar, Phone, Mail, Globe, MessageCircle } from 'lucide-react'\nimport Image from 'next/image'\nimport Button from '@/components/ui/Button'\n\ninterface Development { \n  id: string\n  name: string\n  slug: string\n  description: string | null\n  neighborhood: string\n  city: string\n  state: string\n  price_from: number\n  units: number\n  status: string\n  delivery: string | null\n  image: string | null\n  gallery_images: string[] | null\n  floor_plans: string[] | null\n  videos: string[] | null\n  virtual_tour_url: string | null\n  developer_id: string | null\n  developers ?: { \n    name: string\n    logo_url: string | null\n    website: string | null\n    phone: string | null\n    email: string | null\n }\n } \n\nexport default function DevelopmentDetailPage({ params }: { params: { slug: string } }) { \n  const supabase = createClientComponentClient() \n  const [development, setDevelopment] = useState<Development | null>(null) \n  const [isLoading, setIsLoading] = useState(true) \n  const [selectedImage, setSelectedImage] = useState<string>('') \n\n  useEffect(() => { \n    fetchDevelopment() \n }, [params.slug]) \n\n  async function fetchDevelopment() { \n    const { data, error } = await supabase\n      .from('developments') \n.select(`\n        *,\n        developers (\n          name,\n          logo_url,\n          website,\n          phone,\n          email\n        )\n      `) \n.eq('slug', params.slug) \n.single() \n\n    if (error || !data) { \n      notFound() \n } \n\n    setDevelopment(data) \n    setSelectedImage(data.image || '') \n    setIsLoading(false) \n } \n\n  if (isLoading) { \n    return <div className=\"min-h-screen flex items-center justify-center\">Carregando...</div>\n  }\n\n  if (!development) {\n    notFound()\n  }\n\n  const allImages = [\n    development.image,\n    ...(development.gallery_images || [])\n  ].filter(Boolean) as string[]\n\n  return (\n    <>\n      <section className=\"section-padding bg-slate-50\">\n        <div className=\"container-custom\">\n          <div className=\"grid lg:grid-cols-2 gap-8\">\n            <div>\n              <div className=\"aspect-[4/3] rounded-xl overflow-hidden mb-4\">\n                {selectedImage ? (\n                  <Image\n                    src={selectedImage}\n                    alt={development.name}\n                    width={800}\n                    height={600}\n                    className=\"w-full h-full object-cover\"\n                  />\n                ) : (\n                  <div className=\"w-full h-full bg-slate-200 flex items-center justify-center\">\n                    <Building2 className=\"w-16 h-16 text-slate-400\" />\n                  </div>\n                )}\n              </div>\n\n              {allImages.length > 1 && (\n                <div className=\"grid grid-cols-4 gap-3\">\n                  {allImages.map((img, i) => (\n                    <button\n                      key={i}\n                      onClick={() => setSelectedImage(img)}\n                      className={`aspect-square rounded-lg overflow-hidden border-2 transition-all ${\n                        selectedImage === img ? 'border-navy-900' : 'border-transparent'\n                      }`}\n                    >\n                      <Image\n                        src={img}\n                        alt={`Imagem ${i + 1}`}\n                        width={200}\n                        height={200}\n                        className=\"w-full h-full object-cover\"\n                      />\n                    </button>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <div className=\"flex items-center gap-4 mb-4\">\n                {development.status && (\n                  <span className=\"px-3 py-1 bg-navy-900 text-white text-xs font-semibold rounded-full\">\n                    {development.status}\n                  </span>\n                )}\n                {development.delivery && (\n                  <span className=\"px-3 py-1 bg-gold-500 text-navy-900 text-xs font-bold rounded-full\">\n                    <Calendar className=\"w-3 h-3 inline mr-1\" />\n                    {development.delivery}\n                  </span>\n                )}\n              </div>\n\n              <h1 className=\"font-display text-3xl md:text-4xl font-bold text-navy-900 mb-4\">\n                {development.name}\n              </h1>\n\n              <p className=\"text-slate-600 flex items-center gap-2 mb-6\">\n                <MapPin className=\"w-5 h-5\" />\n                {development.neighborhood}, {development.city} - {development.state}\n              </p>\n\n              <div className=\"mb-6\">\n                <div className=\"text-sm text-slate-500 mb-1\">A partir de</div>\n                <div className=\"font-display text-4xl font-bold text-navy-900\">\n                  {new Intl.NumberFormat('pt-BR', { \n                    style: 'currency', \n                    currency: 'BRL',\n                    minimumFractionDigits: 0 \n                  }).format(development.price_from)}\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-6 mb-8 pb-8 border-b border-slate-200\">\n                <div>\n                  <div className=\"text-sm text-slate-500\">Unidades</div>\n                  <div className=\"text-2xl font-bold text-navy-900\">{development.units}</div>\n                </div>\n              </div>\n\n              {development.description && (\n                <div className=\"mb-8\">\n                  <h2 className=\"font-display text-2xl font-bold text-navy-900 mb-4\">Sobre o Empreendimento</h2>\n                  <p className=\"text-slate-600 leading-relaxed\">{development.description}</p>\n                </div>\n              )}\n\n              <Button asChild size=\"lg\" className=\"w-full\">\n                <a href=\"https://wa.me/5581997230455\" target=\"_blank\" rel=\"noopener noreferrer\">\n                  <MessageCircle className=\"w-5 h-5 mr-2\" />\n                  Falar com Especialista\n                </a>\n              </Button>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {development.floor_plans && development.floor_plans.length > 0 && (\n        <section className=\"section-padding\">\n          <div className=\"container-custom\">\n            <h2 className=\"font-display text-3xl font-bold text-navy-900 mb-8\">Plantas</h2>\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {development.floor_plans.map((plan, i) => (\n                <div key={i} className=\"rounded-xl overflow-hidden border border-slate-200\">\n                  <Image\n                    src={plan}\n                    alt={`Planta ${i + 1}`}\n                    width={600}\n                    height={800}\n                    className=\"w-full h-auto\"\n                  />\n                </div>\n              ))}\n            </div>\n          </div>\n        </section>\n      )}\n\n      {development.developers && (\n        <section className=\"section-padding bg-slate-50\">\n          <div className=\"container-custom\">\n            <h2 className=\"font-display text-3xl font-bold text-navy-900 mb-8\">Construtora</h2>\n            <div className=\"bg-white rounded-xl p-8 border border-slate-200\">\n              <div className=\"flex items-start gap-6\">\n                {development.developers.logo_url && (\n                  <Image\n                    src={development.developers.logo_url}\n                    alt={development.developers.name}\n                    width={120}\n                    height={120}\n                    className=\"object-contain\"\n                  />\n                )}\n                <div className=\"flex-1\">\n                  <h3 className=\"font-display text-2xl font-bold text-navy-900 mb-4\">\n                    {development.developers.name}\n                  </h3>\n                  <div className=\"space-y-2 text-slate-600\">\n                    {development.developers.phone && (\n                      <p className=\"flex items-center gap-2\">\n                        <Phone className=\"w-4 h-4\" />\n                        {development.developers.phone}\n                      </p>\n                    )}\n                    {development.developers.email && (\n                      <p className=\"flex items-center gap-2\">\n                        <Mail className=\"w-4 h-4\" />\n                        {development.developers.email}\n                      </p>\n                    )}\n                    {development.developers.website && (\n                      <p className=\"flex items-center gap-2\">\n                        <Globe className=\"w-4 h-4\" />\n                        <a \n                          href={development.developers.website}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          className=\"text-navy-900 hover:underline\"\n                        >\n                          {development.developers.website}\n                        </a>\n                      </p>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n      )}\n\n      <section className=\"bg-navy-900 text-white section-padding\">\n        <div className=\"container-custom text-center\">\n          <h2 className=\"font-display text-3xl md:text-4xl font-bold mb-6\">\n            Interessado neste Empreendimento?\n          </h2>\n          <p className=\"text-slate-400 text-lg mb-10 max-w-2xl mx-auto\">\n            Fale com nossos especialistas e agende uma visita\n          </p>\n          <Button asChild size=\"lg\" className=\"bg-white text-navy-900 hover:bg-slate-100\">\n            <a href=\"https://wa.me/5581997230455\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <MessageCircle className=\"w-5 h-5 mr-2\" />\n              Entrar em Contato\n            </a>\n          </Button>\n        </div>\n      </section>\n    </>\n  )\n}
